#!/usr/bin/env ruby

self_load_path = File.expand_path("../lib", File.dirname(__FILE__))
unless $LOAD_PATH.include? self_load_path
  $LOAD_PATH << self_load_path
end

require "json"
require "argot"
require "optparse"

f = File.open("/Users/lukeluke/Sites/argon/solr_flattener/data/argot_out.json", "r")
results = []

f.each_line do |line|
  doc = JSON.parse(line)
	results << Argot::Flattener.process(doc)
end

open("/Users/lukeluke/Sites/argon/solr_flattener/data/flattened_out.json", "w") do |f|
	f.puts JSON.pretty_generate(results)
end

f.close